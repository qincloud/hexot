<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[pivot与unpivot使用示例]]></title>
    <url>%2Fhexot%2F2018%2F04%2F13%2Fpivot%E4%B8%8Eunpivot%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%2F</url>
    <content type="text"><![CDATA[一.下面sql创建一个视图123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282CREATE OR REPLACE VIEW TJ_XQ_NLAS SELECT "NF" , "ZM" , "ZMMC" , "FIV" , "SIX" , "SEVEN", "EIGHT", "NIGHT", "QT" FROM ( SELECT * FROM ( SELECT '2017' AS NF , "LEFT"(C.ZM, 1) AS ZM , MAX(J.MC) AS ZMMC , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 5 THEN 1 ELSE 0 END ) AS FIV , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 6 THEN 1 ELSE 0 END ) AS SIX , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 7 THEN 1 ELSE 0 END ) AS SEVEN, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 8 THEN 1 ELSE 0 END ) AS EIGHT, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 9 THEN 1 ELSE 0 END ) AS NIGHT, SUM( CASE WHEN NOT (SUBSTR(C.CSRQ, 3, 1) IN ('5', '6', '7', '8', '9') ) THEN 1 ELSE 0 END ) AS QT FROM GY_DA_JBXX AS C LEFT JOIN GY_XT_ZD AS J ON ( "LEFT"(C.ZM, 1) = J.BM AND J.LB = '1A' ) WHERE EXISTS ( SELECT 1 FROM RP_DA_QMZC AS Q WHERE ( C.SN = Q.ZFSN AND TJNY = '201712' AND ZYBZ = '1' ) ) GROUP BY "LEFT"(C.ZM, 1) ORDER BY "LEFT"(C.ZM, 1) ASC ) UNION ALL SELECT * FROM ( SELECT '2016' AS NF , "LEFT"(C.ZM, 1) AS ZM , MAX(J.MC) AS ZMMC , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 5 THEN 1 ELSE 0 END ) AS FIV , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 6 THEN 1 ELSE 0 END ) AS SIX , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 7 THEN 1 ELSE 0 END ) AS SEVEN, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 8 THEN 1 ELSE 0 END ) AS EIGHT, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 9 THEN 1 ELSE 0 END ) AS NIGHT, SUM( CASE WHEN NOT (SUBSTR(C.CSRQ, 3, 1) IN ('5', '6', '7', '8', '9') ) THEN 1 ELSE 0 END ) AS QT FROM GY_DA_JBXX AS C LEFT JOIN GY_XT_ZD AS J ON ( "LEFT"(C.ZM, 1) = J.BM AND J.LB = '1A' ) WHERE EXISTS ( SELECT 1 FROM RP_DA_QMZC AS Q WHERE ( C.SN = Q.ZFSN AND TJNY = '201612' AND ZYBZ = '1' ) ) GROUP BY "LEFT"(C.ZM, 1) ORDER BY "LEFT"(C.ZM, 1) ASC ) UNION ALL SELECT * FROM ( SELECT '2015' AS NF , "LEFT"(C.ZM, 1) AS ZM , MAX(J.MC) AS ZMMC , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 5 THEN 1 ELSE 0 END ) AS FIV , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 6 THEN 1 ELSE 0 END ) AS SIX , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 7 THEN 1 ELSE 0 END ) AS SEVEN, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 8 THEN 1 ELSE 0 END ) AS EIGHT, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 9 THEN 1 ELSE 0 END ) AS NIGHT, SUM( CASE WHEN NOT (SUBSTR(C.CSRQ, 3, 1) IN ('5', '6', '7', '8', '9') ) THEN 1 ELSE 0 END ) AS QT FROM GY_DA_JBXX AS C LEFT JOIN GY_XT_ZD AS J ON ( "LEFT"(C.ZM, 1) = J.BM AND J.LB = '1A' ) WHERE EXISTS ( SELECT 1 FROM RP_DA_QMZC AS Q WHERE ( C.SN = Q.ZFSN AND TJNY = '201512' AND ZYBZ = '1' ) ) GROUP BY "LEFT"(C.ZM, 1) ORDER BY "LEFT"(C.ZM, 1) ASC ) UNION ALL SELECT * FROM ( SELECT '2014' AS NF , "LEFT"(C.ZM, 1) AS ZM , MAX(J.MC) AS ZMMC , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 5 THEN 1 ELSE 0 END ) AS FIV , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 6 THEN 1 ELSE 0 END ) AS SIX , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 7 THEN 1 ELSE 0 END ) AS SEVEN, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 8 THEN 1 ELSE 0 END ) AS EIGHT, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 9 THEN 1 ELSE 0 END ) AS NIGHT, SUM( CASE WHEN NOT (SUBSTR(C.CSRQ, 3, 1) IN ('5', '6', '7', '8', '9') ) THEN 1 ELSE 0 END ) AS QT FROM GY_DA_JBXX AS C LEFT JOIN GY_XT_ZD AS J ON ( "LEFT"(C.ZM, 1) = J.BM AND J.LB = '1A' ) WHERE EXISTS ( SELECT 1 FROM RP_DA_QMZC AS Q WHERE ( C.SN = Q.ZFSN AND TJNY = '201412' AND ZYBZ = '1' ) ) GROUP BY "LEFT"(C.ZM, 1) ORDER BY "LEFT"(C.ZM, 1) ASC ) UNION ALL SELECT * FROM ( SELECT '2013' AS NF , "LEFT"(C.ZM, 1) AS ZM , MAX(J.MC) AS ZMMC , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 5 THEN 1 ELSE 0 END ) AS FIV , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 6 THEN 1 ELSE 0 END ) AS SIX , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 7 THEN 1 ELSE 0 END ) AS SEVEN, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 8 THEN 1 ELSE 0 END ) AS EIGHT, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 9 THEN 1 ELSE 0 END ) AS NIGHT, SUM( CASE WHEN NOT (SUBSTR(C.CSRQ, 3, 1) IN ('5', '6', '7', '8', '9') ) THEN 1 ELSE 0 END ) AS QT FROM GY_DA_JBXX AS C LEFT JOIN GY_XT_ZD AS J ON ( "LEFT"(C.ZM, 1) = J.BM AND J.LB = '1A' ) WHERE EXISTS ( SELECT 1 FROM RP_DA_QMZC AS Q WHERE ( C.SN = Q.ZFSN AND TJNY = '201312' AND ZYBZ = '1' ) ) GROUP BY "LEFT"(C.ZM, 1) ORDER BY "LEFT"(C.ZM, 1) ASC ) UNION ALL SELECT * FROM ( SELECT '2012' AS NF , "LEFT"(C.ZM, 1) AS ZM , MAX(J.MC) AS ZMMC , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 5 THEN 1 ELSE 0 END ) AS FIV , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 6 THEN 1 ELSE 0 END ) AS SIX , SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 7 THEN 1 ELSE 0 END ) AS SEVEN, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 8 THEN 1 ELSE 0 END ) AS EIGHT, SUM( CASE WHEN SUBSTR(C.CSRQ, 3, 1) = 9 THEN 1 ELSE 0 END ) AS NIGHT, SUM( CASE WHEN NOT (SUBSTR(C.CSRQ, 3, 1) IN ('5', '6', '7', '8', '9') ) THEN 1 ELSE 0 END ) AS QT FROM GY_DA_JBXX AS C LEFT JOIN GY_XT_ZD AS J ON ( "LEFT"(C.ZM, 1) = J.BM AND J.LB = '1A' ) WHERE EXISTS ( SELECT 1 FROM RP_DA_QMZC AS Q WHERE ( C.SN = Q.ZFSN AND TJNY = '201212' AND ZYBZ = '1' ) ) GROUP BY "LEFT"(C.ZM, 1) ORDER BY "LEFT"(C.ZM, 1) ASC ) ); 二.unpivot示范 12345678910111213141516171819202122232425262728293031323334353637383940414243444546select 分类 , 年龄 , 年份2012, 年份2013, 年份2014, 年份2015, 年份2016, 年份2017from ( select zm , zmmc as 分类 , ln as 年龄 , sum(case when nf = '2012' then num else 0 end) as 年份2012, sum(case when nf = '2013' then num else 0 end) as 年份2013, sum(case when nf = '2014' then num else 0 end) as 年份2014, sum(case when nf = '2015' then num else 0 end) as 年份2015, sum(case when nf = '2016' then num else 0 end) as 年份2016, sum(case when nf = '2017' then num else 0 end) as 年份2017 from ( select zm , zmmc, nf , ln , num from ( select * from tj_xq_nl ) xq unpivot(num for ln in(fiv as '50后', six as '60后', seven as '70后', eight as '80后', night as '90后', qt as '其它')) l where zmmc is not null ) group by zm , zmmc, ln order by zm, ln )]]></content>
      <categories>
        <category>sql</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[hexo部署到github]]></title>
    <url>%2Fhexot%2F2018%2F04%2F13%2Fhexo%E9%83%A8%E7%BD%B2%E5%88%B0github%2F</url>
    <content type="text"><![CDATA[hexo官方文档 hexo官方网站主题 在生成以及部署文章之前，需要安装一个扩展：npm install hexo-deployer-git –save然后在hexo服务器文件夹下运行命令: hexo d -g]]></content>
      <categories>
        <category>hexo</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[docker教程]]></title>
    <url>%2Fhexot%2F2018%2F01%2F10%2Fdocker%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[一.docker的安装和docker仓库使用docker的安装作者环境是centos7,建议玩docker小伙伴们也在centos7环境上,centos7必须是64位哦 直接运行下面命令安装centos71yum install docker hub.docker.com的注册dockerhub的官方网址是https://hub.docker.com/ 在上面注册一个帐号就可以上传镜像了,和git提交上传代码是一样的． dockerhub的代码是开源的也可以自己搭建一个docker仓库,这个在以后会有专门的教程]]></content>
      <categories>
        <category>docker</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[superset安装教程]]></title>
    <url>%2Fhexot%2F2017%2F12%2F03%2Fsuperset%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[安装superset本人环境centos7 需要安装python,centos7有自带python 一.安装python 的依赖库和pip1$ yum install libffi-devel python-devel python-pip python-wheel openssl-devel libsasl2-devel openldap-develhi 二.Python virtualenv环境12$ pip install virtualenv #安装virtualenv$ virtualenv venv #进入virtualenv环境 三.安装superset12$ pip install #更新pip$ pip install superset #安装superset 四.设置superset账号和密码123456789$ fabmanager create-admin --app supersetUsername [admin]: adminUser first name [admin]: liaoUser last name [user]: zhqEmail [admin@fab.org]: 996298643@qq.comPassword: Repeat for confirmation: Recognized Database Authentications.Admin User admin created. 五.更新运行初始化运行superset1234567891011$ superset db upgrade #更新superset$ superset init #初始化superset$ superset runserver #运行supersetStarting server with command: gunicorn -w 2 --timeout 60 -b 0.0.0.0:8088 --limit-request-line 0 --limit-request-field_size 0 superset:app[2017-12-03 14:52:30 +0000] [23159] [INFO] Starting gunicorn 19.7.1[2017-12-03 14:52:30 +0000] [23159] [INFO] Listening at: http://0.0.0.0:8088 (23159)[2017-12-03 14:52:30 +0000] [23159] [INFO] Using worker: sync[2017-12-03 14:52:30 +0000] [23164] [INFO] Booting worker with pid: 23164[2017-12-03 14:52:30 +0000] [23165] [INFO] Booting worker with pid: 23165 http://localhost:8088 访问superset]]></content>
      <categories>
        <category>大数据</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[hexo安装实验]]></title>
    <url>%2Fhexot%2F2017%2F12%2F02%2Ftest%2F</url>
    <content type="text"><![CDATA[hexo小白傻瓜安装教程参考博客 安装hexo之前必须安装node.js和git 以下将从我的环境下说明如何安装node.js和hexo 我的电脑环境是centos7 首先下载和安装node.js 第一步下载node.jsnode.js下载地址(我已经上传到csdn) 第二步安装node.js解压后使用命令 1$ tar --strip-components 1 -xzvf node-v* -C /usr/local 可直接copy到/usr/local对应文件夹下面 使用以下命令如果和下面的结果相同说明已经安装好了node.js 12345$ npm -v5.5.1$ node -vv9.2.0 安装好了node.js后就可以开始安装hexo一.下载安装hexo12$ npm install -g hexo$ npm install -g hexo-cli 安装好hexo以后，在终端输入：1$ hexo 如果没有提示找不到该命令说明安装成功。 二.初始化hexo// 建立一个博客文件夹，并初始化博客，为文件夹的名称，可以随便起名字 $ hexo init ${文件夹} // 进入hexo博客文件夹，${文件夹}为文件夹的名称 $ cd ${文件夹} // node.js的命令，根据博客既定的dependencies配置安装所有的依赖包 $ npm install // 安装hexo admin界面功能 $ npm install –save hexo-admin-qiniu 1234$ hexo init /home/lzq996298643/services/hexo$ cd /home/lzq996298643/services/hexo$ npm install$ npm install --save hexo-admin-qiniu 安装完成后可以在/home/lzq996298643/services/hexo看到博客文件夹 三.发表一篇文章和启动hexo必须要在hexo初始化的文件夹下面(/home/lzq996298643/services/hexo)亲测// 新建一篇文章 hexo new “文章标题” //启动hexo hexo server 如果看到以下输出就表明启动成功1234$ hexo server(node:6187) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.INFO Start processingINFO Hexo is running at http://localhost:4000/. Press Ctrl+C to stop. http://localhost:4000 或 http://localhost:4000/admin 访问]]></content>
      <categories>
        <category>hexo</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2Fhexot%2F2017%2F01%2F10%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
      <categories>
        <category>hexo</category>
      </categories>
  </entry>
</search>
